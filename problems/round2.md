# üõ¢ Production Log Aggregator ‚Äî –†–∞—É–Ω–¥ 2 (Sliding Window)

## –ß—Ç–æ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ —ç—Ç–æ–º —Ä–∞—É–Ω–¥–µ

–ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –†–∞—É–Ω–¥–∞ 1 –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –Ω–æ–≤—ã–π —Ç–∏–ø –∑–∞–ø—Ä–æ—Å–∞:

- `PRESSURE_DROP well_id=XXX window=W`

–í—Å–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –†–∞—É–Ω–¥–∞ 1 –æ—Å—Ç–∞—é—Ç—Å—è –≤ —Å–∏–ª–µ (–≤–∫–ª—é—á–∞—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ –æ–±—ä—ë–º –¥–∞–Ω–Ω—ã—Ö –∏ –ø–æ—Ç–æ–∫–æ–≤—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É).

---

## üì• –ù–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å

### 4Ô∏è‚É£ PRESSURE_DROP well_id=XXX window=W

–ù—É–∂–Ω–æ –≤—ã—á–∏—Å–ª–∏—Ç—å **–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –ø–∞–¥–µ–Ω–∏–µ –¥–∞–≤–ª–µ–Ω–∏—è** –≤–Ω—É—Ç—Ä–∏ –ª—é–±–æ–≥–æ –æ–∫–Ω–∞ —Ä–∞–∑–º–µ—Ä–∞ `W` –ø–æ –∑–∞–ø–∏—Å—è–º –¥–∞–Ω–Ω–æ–π —Å–∫–≤–∞–∂–∏–Ω—ã.

–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è:

- –†–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—é—Ç—Å—è **—Ç–æ–ª—å–∫–æ –≤–∞–ª–∏–¥–Ω—ã–µ –∑–∞–ø–∏—Å–∏** –ø–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏ –∏ –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏ (–∫–∞–∫ –≤ –†–∞—É–Ω–¥–µ 1).
- –û–∫–Ω–æ ‚Äî —ç—Ç–æ **W –ø–æ–¥—Ä—è–¥ –∏–¥—É—â–∏—Ö –∑–∞–ø–∏—Å–µ–π** –æ–¥–Ω–æ–π –∏ —Ç–æ–π –∂–µ —Å–∫–≤–∞–∂–∏–Ω—ã –≤ –ø–æ—Ä—è–¥–∫–µ –ø–æ—è–≤–ª–µ–Ω–∏—è –≤–æ –≤—Ö–æ–¥–µ.
- –î–ª—è –∫–∞–∂–¥–æ–≥–æ –æ–∫–Ω–∞ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è:

max(pressure) ‚àí min(pressure)  (–≤–Ω—É—Ç—Ä–∏ –æ–∫–Ω–∞)

- –û—Ç–≤–µ—Ç ‚Äî –º–∞–∫—Å–∏–º—É–º —ç—Ç–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ –≤—Å–µ–º –æ–∫–Ω–∞–º.

### –ì—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏

- –ï—Å–ª–∏ `W <= 0` ‚Üí –≤—ã–≤–µ—Å—Ç–∏ `NA`
- –ï—Å–ª–∏ —Å–∫–≤–∞–∂–∏–Ω–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç ‚Üí –≤—ã–≤–µ—Å—Ç–∏ `NA`
- –ï—Å–ª–∏ —É —Å–∫–≤–∞–∂–∏–Ω—ã –º–µ–Ω—å—à–µ `W` –≤–∞–ª–∏–¥–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π ‚Üí –≤—ã–≤–µ—Å—Ç–∏ `NA`

---

## ‚öôÔ∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (–≤–∞–∂–Ω–æ)

- `DATA` –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –¥–æ **10^7** —Å—Ç—Ä–æ–∫.
- –†–µ—à–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –ø–æ—Ç–æ–∫–æ–≤–æ–º —Ä–µ–∂–∏–º–µ –∏ **–Ω–µ —Ö—Ä–∞–Ω–∏—Ç—å –≤—Å–µ –∑–∞–ø–∏—Å–∏ —Ü–µ–ª–∏–∫–æ–º**.
- –î–ª—è `PRESSURE_DROP` –æ–∂–∏–¥–∞–µ—Ç—Å—è —Ä–µ—à–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **—Å–∫–æ–ª—å–∑—è—â–µ–µ –æ–∫–Ω–æ** –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—É—é –ø–∞–º—è—Ç—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ö—Ä–∞–Ω–∏—Ç —Ç–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã–µ, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è –æ–∫–Ω–∞).

---

## üì§ –§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞

–î–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –≤—ã–≤–æ–¥–∏—Ç—Å—è –æ–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞.

- –ï—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç ‚Äî –≤—ã–≤–µ—Å—Ç–∏ –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ —Å —Ç–æ—á–Ω–æ—Å—Ç—å—é **6 –∑–Ω–∞–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π**
- –ò–Ω–∞—á–µ ‚Äî `NA`

–ü—Ä–∏–º–µ—Ä:

12.500000  
0.000000  
NA

---

## üìå –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –í —ç—Ç–æ–º —Ä–∞—É–Ω–¥–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–¥–¥–µ—Ä–∂–∞—Ç—å –Ω–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å, –Ω–µ –Ω–∞—Ä—É—à–∞—è —Ñ–æ—Ä–º–∞—Ç –≤–≤–æ–¥–∞/–≤—ã–≤–æ–¥–∞ –∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ –∏–∑ –†–∞—É–Ω–¥–∞ 1.
- –õ–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º—ã.
